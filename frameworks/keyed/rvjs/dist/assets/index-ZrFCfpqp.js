(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}})();var ce=Object.defineProperty,G=t=>{throw TypeError(t)},de=(t,e,s)=>e in t?ce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,a=(t,e,s)=>de(t,typeof e!="symbol"?e+"":e,s),J=(t,e,s)=>e.has(t)||G("Cannot "+s),g=(t,e,s)=>(J(t,e,"read from private field"),s?s.call(t):e.get(t)),K=(t,e,s)=>e.has(t)?G("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),j=(t,e,s,r)=>(J(t,e,"write to private field"),e.set(t,s),s);const he=t=>class extends t{constructor(...e){super(...e),a(this,"parent"),a(this,"child"),a(this,"children"),a(this,"componentShortcut"),this.parent=null,this.child=null,this.children=[],this.componentShortcut={parent:null,children:[]}}addChild(e){this.child=e,e.parent=this}removeChild(e){this.child=null,e.parent=null}addChildren(e){this.children.push(e),e.parent=this}get shortcutParent(){return this.componentShortcut.parent}set shortcutParent(e){this.componentShortcut.parent=e}get shortcutChildren(){return this.componentShortcut.children}addShortcutChild(e){this.componentShortcut.children.push(e)}traverseShortcutParent(e,s){e.shortcutParent&&((s(e.shortcutParent)??!1)||this.shortcutParent.traverseShortcutParent(this.shortcutParent,s))}},z=t=>Array.isArray(t),pe=t=>typeof t=="function",Q=t=>typeof t=="function"&&t.hasOwnProperty("$$typeof"),O=t=>typeof t=="object"&&t!==null&&t.hasOwnProperty("$$typeof"),X=Symbol.for("rvjs.componentBlock"),_=Symbol.for("rvjs.elementBlock"),Z=Symbol.for("rvjs.forFlowBlock"),Y=Symbol.for("rvjs.switchFlowBlock"),ee=Symbol.for("rvjs.toggleFlowBlock"),te=Symbol.for("rvjs.textNodeBlock"),se=Symbol.for("rvjs.dynamicRender"),N=Symbol.for("rvjs.getState"),L=t=>O(t)&&t.$$typeof===X,y=t=>O(t)&&t.$$typeof===_,re=t=>O(t)&&t.$$typeof===Z,ue=t=>O(t)&&t.$$typeof===Y,me=t=>O(t)&&t.$$typeof===ee,k=t=>O(t)&&t.$$typeof===te,be=t=>class extends t{constructor(...e){super(...e),a(this,"element"),a(this,"domIndex"),a(this,"domLength"),a(this,"rerenderableIndex"),a(this,"rerenderableChildren");const{element:s}=e[0];this.element=s,this.domIndex=0,this.domLength=0,this.rerenderableIndex=0,this.rerenderableChildren=[]}getChildNodes(){const e=[],s=[this];for(;s.length>0;){const r=s.pop();if(r)if(y(r)||k(r))e.push(r.element);else if(re(r))for(let n=r.children.length-1;n>=0;n--)s.push(r.children[n]);else L(r)?r.lazyRenderContext.isRendered?s.push(r.child):e.push(r.tempElement):s.push(r.child)}return e}requestRerenderableChildrenUpdate(e,s){this.rerenderableChildren.slice(e.rerenderableIndex+1).forEach(r=>{r.domIndex+=s}),this.domLength+=s}requestDOMUpdate(e,s,r,n,l,i){const o=e.parent;if(y(e)){const{domIndex:u}=e.rerenderableChildren[r],v=[...e.element.childNodes].slice(n+u,n+u+l);this.updateDOM(e.element,v,s),e.requestRerenderableChildrenUpdate(e,i)}else{const{domIndex:u}=e.rerenderableChildren[r];e.domLength+=i,o.requestDOMUpdate(o,s,e.rerenderableIndex,n+u,l,i),e.requestRerenderableChildrenUpdate(e,i)}}updateDOM(e,s,r){let n=0,l=s.length-1,i=0,o=r.length-1;for(;n<=l&&i<=o;)s[n]===r[i]?(n++,i++):s[l]===r[o]?(l--,o--):s[n]===r[o]?(e.insertBefore(s[n],s[l].nextSibling),n++,o--):s[l]===r[i]?(e.insertBefore(s[l],s[n]),l--,i++):(e.insertBefore(r[i],s[n]),i++);for(;i<=o;)e.appendChild(r[i]),i++}destroyBlock(e){const s=this;if(e){s.removeChild(e);const r=e.getChildNodes();e.triggerDestroy();for(let n=0;n<r.length;n++)r[n].remove()}}};class ye{}const fe=t=>class extends t{constructor(...e){super(...e),a(this,"pathname"),a(this,"queryParams"),a(this,"pathParam"),a(this,"setOutlet"),a(this,"lazySetOutlet"),this.pathname="",this.queryParams={},this.pathParam=null,this.setOutlet=null,this.lazySetOutlet=null}triggerLazySetOutlet(){this.lazySetOutlet&&this.lazySetOutlet()}},ge=t=>class extends t{constructor(...e){super(...e),a(this,"unsubscribeHandlers"),this.unsubscribeHandlers={state:[],globalState:[]}}addStateUnsubscribeHandler(e){this.unsubscribeHandlers.state.push(e)}addUnsubscribeGlobalStateHandler(e){this.unsubscribeHandlers.globalState.push(e)}cleanUpUnsubscribeState(){this.unsubscribeHandlers.state.forEach(e=>e(this)),this.unsubscribeHandlers.globalState.forEach(e=>{e(this)})}};class ne{constructor(){a(this,"data"),a(this,"front"),a(this,"end"),this.data={},this.front=0,this.end=0}get size(){return this.end-this.front}get items(){return Object.values(this.data)}get first(){return this.data[this.front]}push(e){this.data[this.end]=e,this.end++}pop(){if(this.size===0)return null;const e=this.data[this.front];return delete this.data[this.front],this.front++,e}popAll(e){for(;this.size>0;)e(this.pop())}}const ve={COMPONENT:X,ELEMENT:_,FOR:Z,SWITCH:Y,TOGGLE:ee,TEXT:te};class le extends fe(ge(be(he(ye)))){constructor(...e){super(...e),a(this,"$$typeof");const{type:s}=e[0];this.$$typeof=ve[s]}traverseChildren(e,s){s(e)&&(L(e)||ue(e)||me(e)?e.child&&e.child.traverseChildren(e.child,s):y(e)?e.children.flat().forEach(r=>{r.traverseChildren(r,s)}):re(e)&&e.children.flat().forEach(r=>{r.traverseChildren(r,s)}))}commit(){const e=new ne;this.traverseChildren(this,s=>(L(s)&&(s.isRendered()||s.triggerLazyRender(),e.push(s)),!0)),e.popAll(s=>{s.triggerOnMount()})}destroy(){this.traverseChildren(this,e=>(L(e)&&(e.triggerOnDestroy(),e.deleteAllContextProviders()),k(e)||e.cleanUpUnsubscribeState(),!0))}triggerDestroy(){this.destroy()}}var x;class M{constructor(e){K(this,x),j(this,x,e??null)}has(){return g(this,x)!==null}get(){return g(this,x)}set(e){j(this,x,e)}}x=new WeakMap;new M;const Ce=new Set([]),$=new M,F=t=>{const e=s=>{if(s){$.set(s);const r=t();return $.set(null),r}return t()};return e.$$typeof=se,e},I=t=>Q(t)&&(t==null?void 0:t.$$typeof)===se,we=(t,e)=>{Object.entries(e).forEach(([s,r])=>{U(t,s,r)})},U=(t,e,s)=>{I(s)?Se(t,e,s):q.hasOwnProperty(e)?q[e](t,s):t.element.hasAttribute(e)?t.element.setAttribute(e,s):t.element[e]=s},Se=(t,e,s)=>{U(t,e,s({block:t,type:"domProperty",property:e,value:s}))},q={ref:(t,e)=>{e!==void 0&&(e.current=t.element)},children:(t,e)=>{t.appendChildren(e)},style:(t,e)=>{Object.entries(e).forEach(([s,r])=>{I(r)?t.element.style[s]=r({block:t,type:"styleProperty",property:s,value:r}):t.element.style[s]=r})},animation:(t,e)=>{t.element.animate(e.keyframes,e.options)},classes:(t,e)=>{for(let s=0;s<e.length;s++){const r=e[s];if(I(r)){const n=r();r({block:t,type:"classesProperty",property:"classes",value:{classFn:r,removePrevClassFn:()=>{oe(t.element,n)}}}),D(t.element,n)}else D(t.element,r)}}},xe=(t,e,s)=>{I(s)?t.element.style[e]=s():t.element.style[e]=s},D=(t,e)=>{z(e)?t.classList.add(...e.filter(Boolean)):e!==""&&t.classList.add(e)},oe=(t,e)=>{z(e)?t.classList.remove(...e.filter(Boolean)):e!==""&&t.classList.remove(e)};var b;class Oe{constructor(){K(this,b),j(this,b,new Map)}hasValueBySubscriber(e){return g(this,b).has(e)}getValueBySubscriber(e){return g(this,b).get(e)}createEmptyValue(e,s){g(this,b).set(e,s)}subscribe(e,s){g(this,b).set(e,s)}unsubscribe(e){g(this,b).delete(e)}notify(e){g(this,b).forEach((s,r)=>{e(r,s)})}}b=new WeakMap;const H=t=>{let e=t;const s=new ke;let r=!1;const n=new ne,l=o=>((o||$.has())&&(r?n.push(o??$.get()):s.subscribeState(o??$.get())),Ce.add(l),e);l.$$typeof=N;const i=o=>{o!==e&&(pe(o)?e=o(e):e=o,r=!0,Pe(s),r=!1,n.popAll(u=>{s.subscribeState(u)}))};return i.$$typeof=N,[l,i]},Pe=t=>{const e=[];t.notify((s,r)=>{Object.entries(r.domProperty).forEach(([n,l])=>{y(s)&&U(s,n,l())}),Object.entries(r.styleProperty).forEach(([n,l])=>{y(s)&&xe(s,n,l())}),r.childrenRender.forEach(n=>{n()}),r.flowRender.forEach(n=>{n()}),r.classesProperty.forEach(n=>{const{classFn:l,removePrevClassFn:i}=n,o=l();i(),y(s)&&D(s.element,o),n.removePrevClassFn=()=>{y(s)&&oe(s.element,o)}}),e.push(r.useEffect)}),e.flat().forEach(s=>{s()})},$e=t=>Q(t)&&(t==null?void 0:t.$$typeof)===N;class ke extends Oe{constructor(){super()}subscribeState(e){const{block:s=null,type:r,property:n,value:l}=e;this.hasValueBySubscriber(s)||(super.createEmptyValue(s,{useEffect:[],childrenRender:[],domProperty:{},styleProperty:{},classesProperty:[],flowRender:[]}),s&&!k(s)&&s.addStateUnsubscribeHandler(this.unsubscribe.bind(this)));const i=this.getValueBySubscriber(s);z(i[r])?i[r].push(l):i[r][n]=l}}class Ee extends le{constructor(e){const{dependency:s,render:r}=e;super({type:"FOR"}),a(this,"dependency"),a(this,"render"),a(this,"itemMap"),this.dependency=s,this.render=r,this.itemMap=new Map,this.initialRender()}initialRender(){const e=this.getItems(!0);this.renderChildren(e)}reRender(){const e=this.getItems(!1),{newNodes:s,deletable:r,triggerBlocks:n,increased:l}=this.renderChildren(e),i=[...r];for(let o=0;o<i.length;o++)this.destroyBlock(i[o]);this.parent.requestDOMUpdate(this.parent,s,this.rerenderableIndex,0,this.domLength,l);for(let o=0;o<n.length;o++)n[o].commit()}getItems(e){return $e(this.dependency)?e?this.dependency({block:this,type:"flowRender",property:"flowRender",value:()=>{this.reRender()}}):this.dependency():this.dependency}renderChildren(e){let s=0,r=0,n=0;const l=[],i=[],o=this.itemMap,u=this.itemMap.size;this.itemMap=new Map;const v=new Set(this.children);this.rerenderableChildren=[];for(let C=0;C<e.length;C++){const w=e[C],R=o.has(w);let d;R?(d=o.get(w),v.delete(d)):(d=this.render(w,C),this.addChildren(d)),d&&(this.itemMap.set(w,d),this.addChildren(d),i.push(d),n++,y(d)||k(d)?(s+=1,l.push(d.element)):(d.rerenderableIndex=r++,d.domIndex=s,s+=d.domLength,this.rerenderableChildren.push(d),l.push(...d.getChildNodes())))}return this.domLength=l.length,{newNodes:l,deletable:v,triggerBlocks:i,increased:n-u}}}const Le=(t,e)=>new Ee({dependency:t,render:e});new M;new M({});class ie extends le{constructor(...e){super({type:"ELEMENT",element:e[0].element}),this.domLength=1}appendChildren(e){let s=0,r=0;const n=[],l=document.createDocumentFragment();for(let i=0;i<e.length;i++){const o=e[i];o&&(this.addChildren(o),y(o)||k(o)?(l.appendChild(o.element),s+=1):(o.rerenderableIndex=r++,n.push(o),o.domIndex=s,s+=o.domLength,l.append(...o.getChildNodes())))}this.rerenderableChildren=n,this.element.appendChild(l)}}const Ie=(t,e)=>{const s=new ie({element:t});s.appendChildren([e]),s.commit()},f=(t,e={})=>{const s=new ie({element:document.createElement(t)});return we(s,e),s},A=t=>f("a",t),S=t=>f("button",t),p=t=>f("div",t),Me=t=>f("h1",t),Re=t=>f("span",t),Be=t=>f("table",t),He=t=>f("tbody",t),E=t=>f("td",t),je=t=>f("tr",t),T=["pretty","large","big","small","tall","short","long","handsome","plain","quaint","clean","elegant","easy","angry","crazy","helpful","mushy","odd","unsightly","adorable","important","inexpensive","cheap","expensive","fancy"],V=["red","yellow","blue","green","pink","brown","purple","brown","white","black","orange"],W=["table","chair","house","bbq","desk","car","pony","cookie","sandwich","burger","pizza","mouse","keyboard"],Ne=()=>{const[t,e]=H([]),[s,r]=H(-1);let n=1;const l=()=>{e(B(1e3))},i=()=>{e(B(1e4))},o=()=>{e([...t(),...B(1e3)])},u=()=>{const c=t();for(let h=0;h<c.length;h+=10){const{text:m,setText:P}=c[h];P(m()+" !!!")}e([...c])},v=()=>{e([])},C=()=>{const c=[...t()];if(c.length>998){let h=c[1];c[1]=c[998],c[998]=h,e(c)}},w=c=>{r(c)},R=c=>{const h=t().findIndex(P=>P.id===c),m=[...t().slice(0,h),...t().slice(h+1)];e(m)},d=c=>Math.round(Math.random()*1e3)%c,B=c=>{const h=new Array(c);for(let m=0;m<c;m++){const[P,ae]=H(`${T[d(T.length)]} ${V[d(V.length)]} ${W[d(W.length)]}`);h[m]={id:n++,text:P,setText:ae}}return h};return p({classes:["container"],children:[p({classes:["jumbotron"],children:[p({classes:["row"],children:[p({classes:["col-md-6"],children:[Me({textContent:"@rvjs/core"})]}),p({classes:["col-md-6"],children:[p({classes:["row"],children:[p({classes:["col-sm-6","smallpad"],children:[S({type:"button",id:"run",classes:["btn","btn-primary","btn-block"],textContent:"Create 1,000 rows",onclick:l})]}),p({classes:["col-sm-6","smallpad"],children:[S({type:"button",id:"runlots",classes:["btn","btn-primary","btn-block"],textContent:"Create 10,000 rows",onclick:i})]}),p({classes:["col-sm-6","smallpad"],children:[S({type:"button",id:"add",classes:["btn","btn-primary","btn-block"],textContent:"Append 1,000 rows",onclick:o})]}),p({classes:["col-sm-6","smallpad"],children:[S({type:"button",id:"update",classes:["btn","btn-primary","btn-block"],textContent:"Update every 10th row",onclick:u})]}),p({classes:["col-sm-6","smallpad"],children:[S({type:"button",id:"clear",classes:["btn","btn-primary","btn-block"],textContent:"Clear",onclick:v})]}),p({classes:["col-sm-6","smallpad"],children:[S({type:"button",id:"swaprows",classes:["btn","btn-primary","btn-block"],textContent:"Swap Rows",onclick:C})]})]})]})]})]}),Be({classes:["table","table-hover","table-striped","test-data"],children:[He({children:[Le(t,c=>{const{id:h,text:m}=c;return je({classes:[F(()=>s()===h?"danger":"")],children:[E({classes:["col-md-1"],textContent:String(h)}),E({classes:["col-md-4"],children:[A({onclick:()=>w(h),textContent:F(m)})]}),E({classes:["col-md-1"],children:[A({onclick:()=>R(h),children:[Re({classes:["glyphicon","glyphicon-remove"],ariaHidden:"true"})]})]}),E({classes:["col-md-6"]})]})})]})]})]})};Ie(document.getElementById("app"),Ne());
